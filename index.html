<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¸°ã‚Šé“ãƒ¯ãƒ¼ãƒ«ãƒ‰</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        /* çœç•¥ï¼ˆå…ƒã®CSSã‚’ãã®ã¾ã¾ä½¿ç”¨ï¼‰ */
        /* æ—¢å­˜ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’ã“ã“ã«é…ç½® */
        
        /* ãƒ‡ãƒãƒƒã‚°ç”¨ã‚¹ã‚¿ã‚¤ãƒ«è¿½åŠ  */
        .debug-info {
            position: fixed;
            bottom: 10px;
            right: 10px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 10px;
            border-radius: 5px;
            z-index: 9999;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <!-- çœç•¥ï¼ˆå…ƒã®HTMLã‚’ãã®ã¾ã¾ä½¿ç”¨ï¼‰ -->
    <!-- æ—¢å­˜ã®HTMLã‚³ãƒ¼ãƒ‰ã‚’ã“ã“ã«é…ç½® -->
    
    <!-- ãƒ‡ãƒãƒƒã‚°æƒ…å ±è¡¨ç¤ºç”¨ -->
    <div id="debug-info" class="debug-info" style="display:none;">
        <div id="debug-content"></div>
        <button onclick="clearDebug()" class="mt-2 bg-red-500 text-white px-2 py-1 rounded text-xs">Clear</button>
    </div>
    
    <script>
        // ãƒ‡ãƒãƒƒã‚°é–¢æ•°
        function debug(message) {
            const debugInfo = document.getElementById('debug-info');
            const debugContent = document.getElementById('debug-content');
            debugInfo.style.display = 'block';
            debugContent.innerHTML += message + '<br>';
        }
        
        function clearDebug() {
            document.getElementById('debug-content').innerHTML = '';
        }
        
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã‚’å®šç¾©
        let currentPerspective = 'ritsu';
        let deleteTarget = null;
        
        // å®‰å…¨ã«ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚’ä½¿ç”¨ã™ã‚‹ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
        function safeGetItem(key, defaultValue) {
            try {
                const value = localStorage.getItem(key);
                return value ? JSON.parse(value) : defaultValue;
            } catch (e) {
                debug('ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼: ' + e.message);
                return defaultValue;
            }
        }
        
        function safeSetItem(key, value) {
            try {
                localStorage.setItem(key, JSON.stringify(value));
                return true;
            } catch (e) {
                debug('ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®ä¿å­˜ã‚¨ãƒ©ãƒ¼: ' + e.message);
                return false;
            }
        }
        
        // åˆæœŸåŒ–é–¢æ•°
        function initializeStorage() {
            debug('ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚’åˆæœŸåŒ–ã—ã¦ã„ã¾ã™...');
            if (!safeGetItem('kaerimichiPosts', null)) {
                safeSetItem('kaerimichiPosts', {});
                debug('æŠ•ç¨¿ãƒ‡ãƒ¼ã‚¿ã‚’åˆæœŸåŒ–ã—ã¾ã—ãŸ');
            }
            
            if (!safeGetItem('kaerimichiProgress', null)) {
                safeSetItem('kaerimichiProgress', {
                    'hill': 0,
                    'forest': 0,
                    'sea': 0,
                    'river': 0,
                    'cave': 0,
                    'plain': 0 // äººç‰©ã®å¹³åŸã‚’è¿½åŠ 
                });
                debug('é€²æ—ãƒ‡ãƒ¼ã‚¿ã‚’åˆæœŸåŒ–ã—ã¾ã—ãŸ');
            }
        }
        
        // å…ƒã®JavaScriptã‚³ãƒ¼ãƒ‰ã‚’ä¿®æ­£ã—ã¦ä½¿ç”¨
        // Modalé–¢é€£ã®é–¢æ•°
        function openModal(modal) {
            debug('ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‹ãã¾ã™: ' + modal);
            try {
                const modalElement = document.getElementById(modal + '-modal');
                if (modalElement) {
                    modalElement.style.display = 'block';
                    
                    // æŠ•ç¨¿ã‚’èª­ã¿è¾¼ã‚€
                    if (modal === 'allposts') {
                        loadAllPosts();
                    } else {
                        loadPosts(modal + '-ritsu');
                        loadPosts(modal + '-shuya');
                    }
                } else {
                    debug('ãƒ¢ãƒ¼ãƒ€ãƒ«è¦ç´ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: ' + modal + '-modal');
                }
            } catch (e) {
                debug('ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‹ãéš›ã®ã‚¨ãƒ©ãƒ¼: ' + e.message);
            }
        }
        
        function closeModal(modal) {
            debug('ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã¾ã™: ' + modal);
            try {
                const modalElement = document.getElementById(modal + '-modal');
                if (modalElement) {
                    modalElement.style.display = 'none';
                } else {
                    debug('ãƒ¢ãƒ¼ãƒ€ãƒ«è¦ç´ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: ' + modal + '-modal');
                }
            } catch (e) {
                debug('ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã‚‹éš›ã®ã‚¨ãƒ©ãƒ¼: ' + e.message);
            }
        }
        
        // ã‚¿ãƒ–åˆ‡æ›¿é–¢æ•°
        function switchTab(perspective) {
            debug('ã‚¿ãƒ–ã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã™: ' + perspective);
            currentPerspective = perspective;
            document.getElementById('tab-ritsu').classList.remove('active');
            document.getElementById('tab-shuya').classList.remove('active');
            document.getElementById('tab-' + perspective).classList.add('active');
        }
        
        // ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚¿ãƒ–åˆ‡æ›¿é–¢æ•°
        function switchStoryTab(perspective) {
            debug('ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚¿ãƒ–ã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã™: ' + perspective);
            document.getElementById('story-tab-ritsu').classList.remove('active');
            document.getElementById('story-tab-shuya').classList.remove('active');
            document.getElementById('story-tab-' + perspective).classList.add('active');
            
            document.getElementById('story-content-ritsu').style.display = 'none';
            document.getElementById('story-content-shuya').style.display = 'none';
            document.getElementById('story-content-' + perspective).style.display = 'block';
        }
        
        // ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚¿ãƒ–åˆ‡æ›¿é–¢æ•°
        function switchModalTab(modal, perspective) {
            debug('ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚¿ãƒ–ã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã™: ' + modal + ', ' + perspective);
            document.getElementById(modal + '-tab-ritsu').classList.remove('active');
            document.getElementById(modal + '-tab-shuya').classList.remove('active');
            document.getElementById(modal + '-tab-' + perspective).classList.add('active');
            
            document.getElementById(modal + '-content-ritsu').style.display = 'none';
            document.getElementById(modal + '-content-shuya').style.display = 'none';
            document.getElementById(modal + '-content-' + perspective).style.display = 'block';
        }
        
        // ãƒ’ãƒ³ãƒˆè¡¨ç¤ºé–¢æ•°
        function showHint(id) {
            debug('ãƒ’ãƒ³ãƒˆã‚’è¡¨ç¤ºã—ã¾ã™: ' + id);
            document.getElementById(id + '-hint').style.display = 'block';
            document.getElementById(id + '-hint-btn').style.display = 'none';
        }
        
        function showDetailHint(id) {
            debug('è©³ç´°ãƒ’ãƒ³ãƒˆã‚’è¡¨ç¤ºã—ã¾ã™: ' + id);
            document.getElementById(id + '-detail-hint').style.display = 'block';
        }
        
        // æŠ•ç¨¿é–¢é€£ã®é–¢æ•°
        function addPost(id) {
            debug('æŠ•ç¨¿ã‚’è¿½åŠ ã—ã¾ã™: ' + id);
            const title = document.getElementById(id + '-post-title').value.trim();
            const content = document.getElementById(id + '-post-content').value.trim();
            
            if (!title || !content) {
                alert('ã‚¿ã‚¤ãƒˆãƒ«ã¨å†…å®¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                return;
            }
            
            const now = new Date();
            const post = {
                id: Date.now(),
                title: title,
                content: content,
                date: now.toLocaleDateString() + ' ' + now.toLocaleTimeString(),
                likes: 0
            };
            
            // Get existing posts from localStorage
            const posts = safeGetItem('kaerimichiPosts', {});
            if (!posts[id]) {
                posts[id] = [];
            }
            
            posts[id].unshift(post);
            safeSetItem('kaerimichiPosts', posts);
            
            // Clear form
            document.getElementById(id + '-post-title').value = '';
            document.getElementById(id + '-post-content').value = '';
            
            // Reload posts
            loadPosts(id);
        }
        
        // æŠ•ç¨¿èª­ã¿è¾¼ã¿é–¢æ•°
        function loadPosts(id) {
            debug('æŠ•ç¨¿ã‚’èª­ã¿è¾¼ã¿ã¾ã™: ' + id);
            const postsContainer = document.getElementById(id + '-posts');
            if (!postsContainer) {
                debug('æŠ•ç¨¿ã‚³ãƒ³ãƒ†ãƒŠãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: ' + id + '-posts');
                return;
            }
            
            const posts = safeGetItem('kaerimichiPosts', {})[id] || [];
            
            let html = '';
            if (posts.length === 0) {
                html = '<p class="text-gray-500">ã¾ã æŠ•ç¨¿ãŒã‚ã‚Šã¾ã›ã‚“</p>';
            } else {
                posts.forEach(post => {
                    html += `
                    <div class="post" id="post-${post.id}">
                        <div class="post-title">${post.title}</div>
                        <div class="post-content">${post.content}</div>
                        <div class="post-controls">
                            <span>${post.date}</span>
                            <div>
                                <span class="like-btn" onclick="likePost('${id}', ${post.id})">ğŸ‘ ${post.likes}</span>
                                <span class="delete-btn ml-3" onclick="deletePost('${id}', ${post.id})">ğŸ—‘ï¸ å‰Šé™¤</span>
                            </div>
                        </div>
                    </div>
                    `;
                });
            }
            
            postsContainer.innerHTML = html;
        }
        
        // å…¨æŠ•ç¨¿ã®èª­ã¿è¾¼ã¿ï¼ˆæŠ•ç¨¿ä¸€è¦§ãƒšãƒ¼ã‚¸ç”¨ï¼‰
        function loadAllPosts() {
            debug('å…¨ã¦ã®æŠ•ç¨¿ã‚’èª­ã¿è¾¼ã¿ã¾ã™');
            const postsContainer = document.getElementById('all-posts-container');
            if (!postsContainer) {
                debug('å…¨æŠ•ç¨¿ã‚³ãƒ³ãƒ†ãƒŠãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
                return;
            }
            
            const allPosts = safeGetItem('kaerimichiPosts', {});
            const sectionNames = {
                'hill-ritsu': 'ç‰©èªã®ä¸˜ï¼ˆå¾‹ï¼‰',
                'hill-shuya': 'ç‰©èªã®ä¸˜ï¼ˆå‘¨ä¹Ÿï¼‰',
                'forest-ritsu': 'å¿ƒæƒ…ã®æ£®ï¼ˆå¾‹ï¼‰',
                'forest-shuya': 'å¿ƒæƒ…ã®æ£®ï¼ˆå‘¨ä¹Ÿï¼‰',
                'sea-ritsu': 'å•ã„ã®æµ·ï¼ˆå¾‹ï¼‰',
                'sea-shuya': 'å•ã„ã®æµ·ï¼ˆå‘¨ä¹Ÿï¼‰',
                'river-ritsu': 'è¡¨ç¾ã®å·ï¼ˆå¾‹ï¼‰',
                'river-shuya': 'è¡¨ç¾ã®å·ï¼ˆå‘¨ä¹Ÿï¼‰',
                'cave-ritsu': 'æ§‹é€ ã®æ´çªŸï¼ˆå¾‹ï¼‰',
                'cave-shuya': 'æ§‹é€ ã®æ´çªŸï¼ˆå‘¨ä¹Ÿï¼‰',
                'plain-ritsu': 'äººç‰©ã®å¹³åŸï¼ˆå¾‹ï¼‰',
                'plain-shuya': 'äººç‰©ã®å¹³åŸï¼ˆå‘¨ä¹Ÿï¼‰',
                'story-ritsu': 'æœ¬æ–‡ï¼ˆå¾‹ï¼‰',
                'story-shuya': 'æœ¬æ–‡ï¼ˆå‘¨ä¹Ÿï¼‰'
            };
            
            let html = '';
            let totalPosts = 0;
            
            // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒœã‚¿ãƒ³
            html += `
            <div class="mb-4 flex flex-wrap">
                <button class="filter-btn active bg-gray-200 hover:bg-gray-300" data-filter="all">ã™ã¹ã¦</button>
                <button class="filter-btn bg-gray-200 hover:bg-gray-300" data-filter="story">æœ¬æ–‡</button>
                <button class="filter-btn bg-gray-200 hover:bg-gray-300" data-filter="hill">ç‰©èªã®ä¸˜</button>
                <button class="filter-btn bg-gray-200 hover:bg-gray-300" data-filter="forest">å¿ƒæƒ…ã®æ£®</button>
                <button class="filter-btn bg-gray-200 hover:bg-gray-300" data-filter="sea">å•ã„ã®æµ·</button>
                <button class="filter-btn bg-gray-200 hover:bg-gray-300" data-filter="river">è¡¨ç¾ã®å·</button>
                <button class="filter-btn bg-gray-200 hover:bg-gray-300" data-filter="cave">æ§‹é€ ã®æ´çªŸ</button>
                <button class="filter-btn bg-gray-200 hover:bg-gray-300" data-filter="plain">äººç‰©ã®å¹³åŸ</button>
                <button class="filter-btn bg-gray-200 hover:bg-gray-300" data-filter="ritsu">å¾‹ã®è¦–ç‚¹</button>
                <button class="filter-btn bg-gray-200 hover:bg-gray-300" data-filter="shuya">å‘¨ä¹Ÿã®è¦–ç‚¹</button>
            </div>
            `;
            
            // å„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®æŠ•ç¨¿ã‚’å‡¦ç†
            Object.keys(allPosts).forEach(section => {
                if (allPosts[section] && allPosts[section].length > 0) {
                    const posts = allPosts[section];
                    totalPosts += posts.length;
                    
                    posts.forEach(post => {
                        const sectionName = sectionNames[section] || section;
                        // å¿…è¦ãªãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚¯ãƒ©ã‚¹ã‚’è¿½åŠ 
                        const filterClasses = section.split('-').join(' ');
                        
                        html += `
                        <div class="post post-item ${filterClasses}" id="allpost-${post.id}">
                            <div class="post-location">${sectionName}</div>
                            <div class="post-title">${post.title}</div>
                            <div class="post-content">${post.content}</div>
                            <div class="post-controls">
                                <span>${post.date}</span>
                                <div>
                                    <span class="like-btn" onclick="likePost('${section}', ${post.id}, true)">ğŸ‘ ${post.likes}</span>
                                </div>
                            </div>
                        </div>
                        `;
                    });
                }
            });
            
            if (totalPosts === 0) {
                html = '<p class="text-gray-500">ã¾ã æŠ•ç¨¿ãŒã‚ã‚Šã¾ã›ã‚“</p>';
            }
            
            postsContainer.innerHTML = html;
            
            // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒœã‚¿ãƒ³ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã‚’è¨­å®š
            document.querySelectorAll('.filter-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const filter = this.getAttribute('data-filter');
                    
                    // ãƒœã‚¿ãƒ³ã®è¦‹ãŸç›®ã‚’æ›´æ–°
                    document.querySelectorAll('.filter-btn').forEach(btn => {
                        btn.classList.remove('active', 'bg-green-500', 'text-white');
                        btn.classList.add('bg-gray-200');
                    });
                    this.classList.add('active', 'bg-green-500', 'text-white');
                    this.classList.remove('bg-gray-200');
                    
                    // æŠ•ç¨¿ã‚’è¡¨ç¤º/éè¡¨ç¤º
                    document.querySelectorAll('.post-item').forEach(post => {
                        if (filter === 'all') {
                            post.style.display = 'block';
                        } else {
                            if (post.classList.contains(filter)) {
                                post.style.display = 'block';
                            } else {
                                post.style.display = 'none';
                            }
                        }
                    });
                });
            });
        }
        
        // ã„ã„ã­æ©Ÿèƒ½
        function likePost(section, postId, reload = false) {
            debug('ã„ã„ã­ã—ã¾ã™: ' + section + ', ' + postId);
            const posts = safeGetItem('kaerimichiPosts', {});
            const sectionPosts = posts[section] || [];
            
            const postIndex = sectionPosts.findIndex(p => p.id === postId);
            if (postIndex !== -1) {
                sectionPosts[postIndex].likes++;
                posts[section] = sectionPosts;
                safeSetItem('kaerimichiPosts', posts);
                
                if (reload) {
                    loadAllPosts();
                } else {
                    loadPosts(section);
                }
            }
        }
        
        // å‰Šé™¤æ©Ÿèƒ½
        function deletePost(section, postId) {
            debug('å‰Šé™¤ã—ã¾ã™: ' + section + ', ' + postId);
            deleteTarget = { section, postId };
            document.getElementById('delete-modal').style.display = 'flex';
            document.getElementById('admin-password').focus();
            document.getElementById('password-error').style.display = 'none';
        }
        
        function cancelDelete() {
            debug('å‰Šé™¤ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã—ã¾ã™');
            deleteTarget = null;
            document.getElementById('delete-modal').style.display = 'none';
            document.getElementById('admin-password').value = '';
        }
        
        function confirmDelete() {
            debug('å‰Šé™¤ã‚’ç¢ºèªã—ã¾ã™');
            const password = document.getElementById('admin-password').value;
            
            if (password === 'admin') {
                if (deleteTarget) {
                    const { section, postId } = deleteTarget;
                    const posts = safeGetItem('kaerimichiPosts', {});
                    const sectionPosts = posts[section] || [];
                    
                    const newPosts = sectionPosts.filter(p => p.id !== postId);
                    posts[section] = newPosts;
                    safeSetItem('kaerimichiPosts', posts);
                    
                    // Close modal and reload posts
                    document.getElementById('delete-modal').style.display = 'none';
                    document.getElementById('admin-password').value = '';
                    loadPosts(section);
                }
            } else {
                document.getElementById('password-error').style.display = 'block';
            }
        }
        
        // é€²æ—ç®¡ç†é–¢é€£ã®é–¢æ•°
        function updateProgress(point) {
            debug('é€²æ—ã‚’æ›´æ–°ã—ã¾ã™: ' + point);
            const progress = safeGetItem('kaerimichiProgress', {});
            
            // Count checked checkboxes
            let checkedCount = 0;
            if (document.getElementById(point + '-ritsu-check1') && document.getElementById(point + '-ritsu-check1').checked) checkedCount++;
            if (document.getElementById(point + '-ritsu-check2') && document.getElementById(point + '-ritsu-check2').checked) checkedCount++;
            if (document.getElementById(point + '-shuya-check1') && document.getElementById(point + '-shuya-check1').checked) checkedCount++;
            if (document.getElementById(point + '-shuya-check2') && document.getElementById(point + '-shuya-check2').checked) checkedCount++;
            
            // Calculate percentage (4 total checkboxes per point)
            const percentage = Math.round((checkedCount / 4) * 100);
            progress[point] = percentage;
            
            // Update localStorage
            safeSetItem('kaerimichiProgress', progress);
            
            // Update UI
            updatePointProgress(point, percentage);
            updateOverallProgress();
        }
        
        function updatePointProgress(point, percentage) {
            debug('ãƒã‚¤ãƒ³ãƒˆã®é€²æ—ã‚’æ›´æ–°ã—ã¾ã™: ' + point + ', ' + percentage + '%');
            // Update progress badge on map
            const pointElements = document.querySelectorAll('.' + point + ' .progress-badge');
            pointElements.forEach(el => {
                el.textContent = percentage + '%';
            });
        }
        
        function updateOverallProgress() {
            debug('å…¨ä½“ã®é€²æ—ã‚’æ›´æ–°ã—ã¾ã™');
            const progress = safeGetItem('kaerimichiProgress', {});
            const points = Object.keys(progress);
            
            let total = 0;
            points.forEach(point => {
                total += progress[point];
            });
            
            const overallPercentage = Math.round(total / points.length);
            
            // Update progress bar and text
            const progressBar = document.getElementById('overall-progress');
            const progressText = document.getElementById('overall-progress-text');
            
            if (progressBar && progressText) {
                progressBar.style.width = overallPercentage + '%';
                progressText.textContent = overallPercentage + '%';
            } else {
                debug('é€²æ—ãƒãƒ¼ã¾ãŸã¯ãƒ†ã‚­ã‚¹ãƒˆè¦ç´ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
            }
        }
        
        function updateAllProgress() {
            debug('ã™ã¹ã¦ã®é€²æ—ã‚’æ›´æ–°ã—ã¾ã™');
            const progress = safeGetItem('kaerimichiProgress', {});
            
            // Set checkbox states based on progress
            Object.keys(progress).forEach(point => {
                updatePointProgress(point, progress[point]);
                
                // Calculate how many checkboxes should be checked
                const checksToCheck = Math.round((progress[point] / 100) * 4);
                let checksChecked = 0;
                
                // Check checkboxes in order if they exist
                if (checksChecked < checksToCheck && document.getElementById(point + '-ritsu-check1')) {
                    document.getElementById(point + '-ritsu-check1').checked = true;
                    checksChecked++;
                }
                
                if (checksChecked < checksToCheck && document.getElementById(point + '-ritsu-check2')) {
                    document.getElementById(point + '-ritsu-check2').checked = true;
                    checksChecked++;
                }
                
                if (checksChecked < checksToCheck && document.getElementById(point + '-shuya-check1')) {
                    document.getElementById(point + '-shuya-check1').checked = true;
                    checksChecked++;
                }
                
                if (checksChecked < checksToCheck && document.getElementById(point + '-shuya-check2')) {
                    document.getElementById(point + '-shuya-check2').checked = true;
                    checksChecked++;
                }
            });
            
            updateOverallProgress();
        }
        
        // ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆèª­ã¿è¾¼ã¿å®Œäº†æ™‚ã®å‡¦ç†
        document.addEventListener('DOMContentLoaded', function() {
            debug('ãƒšãƒ¼ã‚¸ã‚’åˆæœŸåŒ–ã—ã¦ã„ã¾ã™...');
            try {
                // ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®åˆæœŸåŒ–
                initializeStorage();
                
                // æŠ•ç¨¿ã¨é€²æ—ã®èª­ã¿è¾¼ã¿
                loadAllPosts();
                updateAllProgress();
                
                debug('åˆæœŸåŒ–å®Œäº†');
            } catch (e) {
                debug('åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼: ' + e.message);
            }
        });
    </script>
</body>
</html>
